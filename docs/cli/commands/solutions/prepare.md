---
id: "cli-solutions-prepare"
title: "solutions prepare"
slug: "/commands/solutions/prepare"
sidebar_label: "prepare"
---

Packs and signs a <a id="solution"><span className="dashed-underline">solution</span></a> with [Gramine](https://gramineproject.io/) and writes a [manifest](https://gramine.readthedocs.io/en/stable/manifest-syntax.html).

This allows the execution of the "graminized" solution code inside a <a id="tee"><span className="dashed-underline">Trusted Execution Environment</span></a>. When the solution is prepared and packed, you can [upload](/cli/commands/files/upload) the resulting archive to a distributed storage to use the solution in <a id="order"><span className="dashed-underline">orders</span></a>.

The input of the command is the following:

- Directory with the solution and all its dependencies
- Signing key file generated by the [solutions generate-key](/cli/commands/solutions/generate-key) command
- Node.js or Python base image downloaded from their respective <a id="offer"><span className="dashed-underline">offers</span></a> using the [`offers download-content`](/cli/commands/offers/download-content) command:
  - Python Base Image: `./spctl offers download-content 12`
  - Node.js Base Image: `./spctl offers download-content 13`

The output of the command:

- TAR.GZ archive file with graminized solution and dependencies.
- JSON file with essential metadata.

Note that the base image is graminized but not included in the output archive file and must be added to the <a id="order"><span className="dashed-underline">order</span></a> separately.

## Syntax

```
./spctl solutions prepare <solutionPath> <signingKeyPath>
    [--base-image-path <path>]
    [--metadata <path>]
    [--pack-solution <path>]
    [--write-default-manifest]
    [--env <envVariable> [--env ...]]
    [--hash-algo <hashAlgo>]
    [--sgx-max-threads <number>]
    [--sgx-enclave-size <number>]
    [--sgx-loader-internal-size <number>]
    [--sgx-stack-size <number>]
    [--config <path>]
    [--help | -h]
```

## Arguments

| **Name** | **Description** |
| :- | :- |
| `<solutionPath>` | Path to the solution directory. |
| `<solutionKeyPath>` | Path to the signing key file. |

## Options

| <div style={{width:235}}>**Name**</div> | **Description** |
| :- | :- |
| `--base-image-path <path>` | Path to the base image file. |
| `--metadata <path>` | Path to save the resulting metadata file (hash and MrEnclave). The default is `./metadata.json`. |
| `--pack-solution <path>` | Path to save the resulting TAR.GZ archive file. |
| `--write-default-manifest` | Write a default manifest for solutions with empty MrEnclave. The default is `false`. |
| `--env <envVariable>` | Environment variable to set into solution manifest. You can use this option multiple times. |
| `--hash-algo <hashAlgo>` | Hash calculation algorithm for the solution. The default is `sha256`. |
| `--sgx-max-threads <number>` | Number of maximum threads, a Gramine 1.4 option. |
| `--sgx-enclave-size <size>` | Entire enclave size, must be a power of 2. Append the unit M (MiB) or G (GiB) to the value. For example, `16G` means 16 GiB.|
| `--sgx-stack-size <size>` | Size of the enclave thread stack. Append the unit K (KiB), M (MiB), or G (GiB) to the value. For example, `1M` means 1 MiB.|
| `--config <path>` | Path to the SPCTL configuration file. The default is `./config.json`. |
| `--help`, `-h` | Help for the command. |

## Example

```
./spctl solutions prepare ./my-solution/run ./my-solution/signing-key \
    --base-image-path ./base-solution-image.tar.gz 
```