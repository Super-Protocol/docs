---
id: "solutions-prepare"
title: "solutions prepare"
slug: "/cli_commands/solutions/prepare"
sidebar_label: "prepare"
---

Packs and signs a solution with [Gramine](https://gramineproject.io/) and writes a [manifest](https://gramine.readthedocs.io/en/stable/manifest-syntax.html).

This allows the execution of the "graminized" solution code inside a Trusted Execution Environment. When the solution is prepared and packed, you can [upload](/developers/cli_commands/files/upload) the resulting archive to a distributed storage to use the solution in orders.

The input of the command is the following:

- Directory with the solution and all its dependencies
- Signing key file generated by the [solutions generate-key](/developers/cli_commands/solutions/generate-key) command
- Node.js or Python base image downloaded from their respective offers using the [offers download-content](/developers/cli_commands/offers/offers/download-content) command:
  + Python Base Image: `./spctl offers download-content 5`
  + Node.js Base Image: `./spctl offers download-content 6`.

The output of the command is the following:

- TAR.GZ archive file with graminized solution and dependencies
- JSON file with essential metadata.

Note that the base image is graminized but not included in the output archive file and must be added to the order separately.

## Syntax

```
./spctl solutions prepare <solutionPath> <signingKeyPath>
    [--base-image-path <path>] \
    [--metadata <path>] \
    [--pack-solution <path>] \
    [--write-default-manifest {true ┃ false}] \
    [--env <envVar>,[<envVar>,...]] \
    [--hash-algo <hashAlgo>] \
    [--sgx-max-threads <number>] \
    [--sgx-enclave-size <number>] \
    [--sgx-enclave-size <number>] \
    [--sgx-loader-internal-size <number>] \
    [--sgx-stack-size <number>] \
    [--config <path>] \
    [--help ┃ -h]
```

## Arguments

| **Name** | **Description** |
| :- | :- |
| `<solutionPath>` | Path to the solution directory. |
| `<solutionKeyPath>` | Path to the signing key file. |

## Options

| **Name** | **Description** |
| :- | :- |
| `--base-image-path <path>` | Path to the base image file. |
| `--metadata <path>` | Path to save the resulting metadata file (hash and MrEnclave). The default is `./metadata.json`. |
| `--pack-solution <path>` | Path to save the resulting TAR.GZ archive file. |
| `--write-default-manifest {true ┃ false}` | Write a default manifest for solutions with empty MrEnclave. The default is `false`. |
| `--env <envVar>,[<envVar>,...]` | List of environment variables to set into solution manifest. |
| `--hash-algo <hashAlgo>` | Hash calculation algorithm for the solution. The default is `sha256`. |
| `--sgx-max-threads <number>` | Number of maximum threads, a Gramine 1.4 option. |
| `--sgx-enclave-size <number>` | Entire enclave size (#M or #G), must be a power of 2. |
| `--sgx-loader-internal-size <number>`| Size of the internal enclave structs (#M or #G). |
| `--sgx-stack-size <number>` | Size of the enclave thread stack (#K, #M or #G). |
| `--config <path>` | Path to the SPCTL configuration file. The default is `./config.json`. |
| `--help`, `-h` | Help for the command. |

## Example

The following command prepares a solution:

```
./spctl solutions prepare ./my-solution/run ./my-solution/signing-key \
    --base-image-path ./base-solution-image.tar.gz 
```

Where:

- `./my-solution/run`: solution directory
- `./my-solution/signing-key`: path to the signing key
- `--base-image-path ./base-solution-image.tar.gz`: path to the base image file `base-solution-image.tar.gz`.