---
id: "solutions-prepare"
title: "Prepare a solution"
slug: "/cli_commands/solutions/prepare"
sidebar_label: "prepare"
---

This command packs a solution, signs it with [Gramine](https://gramineproject.io/), and writes a [manifest](https://gramine.readthedocs.io/en/stable/manifest-syntax.html). It allows the execution of the "graminized" solution code inside the Intel SGX confidential enclave (trusted execution environment or TEE).

When the solution is prepared and packed, you can [upload](/developers/cli_commands/files/upload) the resulting archive to a distributed storage to use the solution in orders.

## Usage

```
./spctl solutions prepare <solutionPath> <signingKeyPath> --base-image-path <baseImagePath> [options]
```

**Input**

- directory with the solution and all its dependencies;
- signing key file generated by the [solutions generate-key](/developers/cli_commands/solutions/generate-key) command;
- Node.js or Python base image downloaded from their respective offers using the [offers download-content](/developers/cli_commands/offers/offers/download-content) command:
  + Python Base Image: `./spctl offers download-content 5`;
  + Node.js Base Image: `./spctl offers download-content 6`.

**Output**

- TAR.GZ archive with graminized solution and dependencies. The base image is graminized but not included in the archive and must be added to the order separately;
- JSON file with essential metadata.

### Mandatory arguments

|**Name**         |**Description**               |
|:----------------|:-----------------------------|
|`solutionPath`   |Path to the solution directory|
|`solutionKeyPath`|Path to the key file          |
|`baseImagePath`  |Path to the base image        |

### Options

|**Name, shorthand**                        |**Default**      |**Description**                                                  |
|:------------------------------------------|:----------------|:----------------------------------------------------------------|
|`--metadata <pathToSave>`                  |`./metadata.json`|Path to save the resulting metadata file (hash and MrEnclave)    |
|`--pack-solution <packSolution>`           |                 |Path to save the resulting TAR.GZ archive                        |
|`--write-default-manifest`                 |`false`          |Write a default manifest for solutions with empty MrEnclave      |
|`--env <envs...>`                          |                 |List of environment variables to set into solution manifest      |
|`--hash-algo <solutionHashAlgo>`           |`sha256`         |Hash calculation algorithm for the solution                      |
|`--sgx-max-threads <maxThreads>`           |                 |Number of maximum threads, a Gramine 1.4 option                  |
|`--sgx-enclave-size <enclaveSize>`         |                 |Entire enclave size (#M or #G), must be a value to the power of 2|
|`--sgx-loader-internal-size <internalSize>`|                 |Size of the internal enclave structs (#M or #G)                  |
|`--sgx-stack-size <stackSize>`             |                 |Size of the enclave thread stack (#K, #M or #G)                  |
|`--config <configPath>`                    |`"./config.json"`|Path to the configuration file                                   |
|`--help`, `-h`                             |                 |Display help for the command                                     |

## Example

```
./spctl solutions prepare ./my-solution/run ./my-solution/signing-key.pem --base-image-path ./base_image.tar.gz 
```

Where:
- `./my-solution/run` – path to the solution directory;
- `./my-solution/signing-key.pem` – path to the signing key file;
- `--base-image-path ./base_image.tar.gz` – path to the Node.js or Python base image.